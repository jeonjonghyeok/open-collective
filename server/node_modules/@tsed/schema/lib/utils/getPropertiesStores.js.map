{"version":3,"file":"getPropertiesStores.js","sourceRoot":"","sources":["../../src/utils/getPropertiesStores.ts"],"names":[],"mappings":";;;AAEA,oDAAgD;AAChD,6DAAwD;AACxD,6DAAwD;AAExD;;;GAGG;AACH,SAAgB,mBAAmB,CACjC,MAAuB;IAEvB,MAAM,KAAK,GAAQ,MAAM,CAAC,OAAO,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,uCAAkB,CAAC,MAAM,CAAC,CAAC;IAExE,IAAI,CAAC,KAAK,CAAC,WAAW,EAAE;QACtB,MAAM,MAAM,GAAG,uCAAkB,CAAC,KAAK,CAAC,CAAC;QACzC,KAAK,CAAC,WAAW,GAAG,IAAI,GAAG,EAAE,CAAC;QAE9B,MAAM,CAAC,OAAO,CAAC,CAAC,YAAY,EAAE,EAAE;YAC9B,YAAY,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,SAAS,EAAE,EAAE;gBAC1C,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,GAAG,CAAC,SAAS,CAAC,WAAW,CAAC,EAAE;oBACjD,KAAK,CAAC,WAAW,CAAC,GAAG,CAAC,SAAS,CAAC,WAAW,EAAE,SAAS,CAAC,CAAC;iBACzD;YACH,CAAC,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;KACJ;IAED,OAAO,KAAK,CAAC,WAAW,CAAC;AAC3B,CAAC;AAnBD,kDAmBC;AAQD,SAAgB,aAAa,CAAC,MAAiB,EAAE,UAAgC,EAAE;IACjF,MAAM,MAAM,GAAG,mBAAmB,CAAC,MAAM,CAAC,CAAC;IAE3C,MAAM,CAAC,OAAO,CAAC,CAAC,KAAK,EAAE,GAAG,EAAE,EAAE;QAC5B,IAAI,CAAC,OAAO,CAAC,gBAAgB,EAAE;YAC7B,IAAI,wBAAW,CAAC,KAAK,CAAC,UAAU,EAAE,EAAE,CAAC,EAAE;gBACrC,MAAM,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;aACpB;SACF;IACH,CAAC,CAAC,CAAC;IAEH,OAAO,MAAM,CAAC;AAChB,CAAC;AAZD,sCAYC","sourcesContent":["import {Type} from \"@tsed/core\";\nimport {JsonEntityStore} from \"../domain/JsonEntityStore\";\nimport {alterIgnore} from \"../hooks/ignoreHook\";\nimport {getInheritedStores} from \"./getInheritedStores\";\nimport {getJsonEntityStore} from \"./getJsonEntityStore\";\n\n/**\n * Return the list of properties including properties from inherited classes\n * @param target\n */\nexport function getPropertiesStores<T extends JsonEntityStore = JsonEntityStore>(\n  target: Type<any> | any\n): Map<string | symbol | number, T> {\n  const store: any = target.isStore ? target : getJsonEntityStore(target);\n\n  if (!store.$properties) {\n    const stores = getInheritedStores(store);\n    store.$properties = new Map();\n\n    stores.forEach((currentStore) => {\n      currentStore.children.forEach((propStore) => {\n        if (!store.$properties.has(propStore.propertyKey)) {\n          store.$properties.set(propStore.propertyKey, propStore);\n        }\n      });\n    });\n  }\n\n  return store.$properties;\n}\n\nexport interface GetPropertiesOptions {\n  withIgnoredProps?: boolean;\n\n  [type: string]: any;\n}\n\nexport function getProperties(target: Type<any>, options: GetPropertiesOptions = {}) {\n  const stores = getPropertiesStores(target);\n\n  stores.forEach((store, key) => {\n    if (!options.withIgnoredProps) {\n      if (alterIgnore(store.itemSchema, {})) {\n        stores.delete(key);\n      }\n    }\n  });\n\n  return stores;\n}\n"]}