{"version":3,"file":"createHandlerMetadata.js","sourceRoot":"","sources":["../../../src/platform/utils/createHandlerMetadata.ts"],"names":[],"mappings":";;;AACA,kEAA6D;AAC7D,wEAAmE;AACnE,sEAAyF;AAGzF,SAAS,UAAU,CAAC,KAAU;IAC5B,OAAO,KAAK,YAAY,iCAAe,CAAC;AAC1C,CAAC;AAED;;GAEG;AACH,SAAgB,qBAAqB,CACnC,QAAyB,EACzB,GAA2B,EAC3B,eAA6C,EAAE;IAE/C,IAAI,UAAU,CAAC,GAAG,CAAC,EAAE;QACnB,OAAO,GAAsB,CAAC;KAC/B;IAED,IAAI,OAA+B,CAAC;IAEpC,IAAI,GAAG,YAAY,mCAAgB,EAAE;QACnC,MAAM,QAAQ,GAAG,QAAQ,CAAC,WAAW,CAAC,GAAG,CAAC,KAAK,CAAE,CAAC;QAElD,OAAO,GAAG;YACR,KAAK,EAAE,QAAQ,CAAC,KAAK;YACrB,MAAM,EAAE,QAAQ,CAAC,QAAQ;YACzB,IAAI,EAAE,yBAAW,CAAC,QAAQ;YAC1B,WAAW,EAAE,GAAG,CAAC,WAAW;SAC7B,CAAC;KACH;SAAM;QACL,MAAM,QAAQ,GAAG,QAAQ,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC;QAE3C,IAAI,QAAQ,EAAE;YACZ,OAAO,GAAG;gBACR,KAAK,EAAE,QAAQ,CAAC,KAAK;gBACrB,MAAM,EAAE,QAAQ,CAAC,QAAQ;gBACzB,IAAI,EAAE,yBAAW,CAAC,UAAU;gBAC5B,WAAW,EAAE,KAAK;aACnB,CAAC;SACH;aAAM;YACL,OAAO,GAAG;gBACR,MAAM,EAAE,GAAG;aACZ,CAAC;SACH;KACF;IAED,OAAO,CAAC,YAAY,GAAG,YAAY,CAAC;IAEpC,OAAO,IAAI,iCAAe,CAAC,OAAO,CAAC,CAAC;AACtC,CAAC;AAxCD,sDAwCC","sourcesContent":["import {InjectorService} from \"@tsed/di\";\nimport {HandlerType} from \"../../mvc/interfaces/HandlerType\";\nimport {EndpointMetadata} from \"../../mvc/models/EndpointMetadata\";\nimport {HandlerMetadata, HandlerMetadataOptions} from \"../../mvc/models/HandlerMetadata\";\nimport type {PlatformRouteWithoutHandlers} from \"../interfaces/PlatformRouterMethods\";\n\nfunction isMetadata(input: any) {\n  return input instanceof HandlerMetadata;\n}\n\n/**\n * @ignore\n */\nexport function createHandlerMetadata(\n  injector: InjectorService,\n  obj: any | EndpointMetadata,\n  routeOptions: PlatformRouteWithoutHandlers = {}\n): HandlerMetadata {\n  if (isMetadata(obj)) {\n    return obj as HandlerMetadata;\n  }\n\n  let options: HandlerMetadataOptions;\n\n  if (obj instanceof EndpointMetadata) {\n    const provider = injector.getProvider(obj.token)!;\n\n    options = {\n      token: provider.token,\n      target: provider.useClass,\n      type: HandlerType.ENDPOINT,\n      propertyKey: obj.propertyKey\n    };\n  } else {\n    const provider = injector.getProvider(obj);\n\n    if (provider) {\n      options = {\n        token: provider.token,\n        target: provider.useClass,\n        type: HandlerType.MIDDLEWARE,\n        propertyKey: \"use\"\n      };\n    } else {\n      options = {\n        target: obj\n      };\n    }\n  }\n\n  options.routeOptions = routeOptions;\n\n  return new HandlerMetadata(options);\n}\n"]}