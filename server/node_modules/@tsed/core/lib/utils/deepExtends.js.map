{"version":3,"file":"deepExtends.js","sourceRoot":"","sources":["../../src/utils/deepExtends.ts"],"names":[],"mappings":"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","sourcesContent":["import {HashOf} from \"../interfaces/HashOf\";\nimport {objectKeys} from \"./objectKeys\";\nimport {classOf, isArrayOrArrayClass, isPrimitive, isPrimitiveOrPrimitiveClass} from \"./ObjectUtils\";\n\nexport type DeepExtendsReducers = HashOf<(collection: any[], value: any) => any>;\n\nfunction reducer() {\n  return (collection: any[], value: any) => {\n    collection.indexOf(value) === -1 && collection.push(value);\n\n    return collection;\n  };\n}\n\n/**\n * Deep extends a model with another one.\n * @param out\n * @param obj\n * @param reducers\n * @returns {any}\n */\nexport function deepExtends(out: any, obj: any, reducers: DeepExtendsReducers = {}): any {\n  if (obj === undefined || obj === null) {\n    return out;\n  }\n\n  if (isPrimitive(obj) || typeof obj === \"symbol\" || typeof obj === \"function\") {\n    return obj;\n  }\n\n  if (isArrayOrArrayClass(obj)) {\n    out = out || [];\n  } else {\n    out = out || (obj ? (classOf(obj) !== Object ? Object.create(obj) : {}) : {});\n  }\n\n  const defaultReducer = reducers[\"default\"] ? reducers[\"default\"] : reducer();\n\n  const set = (key: string | number, value: any) => {\n    if (isArrayOrArrayClass(obj)) {\n      out.indexOf(value) === -1 && out.push(value);\n    } else {\n      out[key] = value;\n    }\n  };\n\n  objectKeys(obj).forEach((key) => {\n    let value = obj[key];\n\n    if (value === undefined || value === null) {\n      return;\n    }\n\n    if (value === \"\" && out[key] !== \"\") {\n      return;\n    }\n\n    if (isPrimitiveOrPrimitiveClass(value) || typeof value === \"function\") {\n      set(key, value);\n\n      return;\n    }\n\n    if (isArrayOrArrayClass(value)) {\n      value = value.map((value: any) => deepExtends(undefined, value));\n\n      set(\n        key,\n        []\n          .concat(out[key] || [], value)\n          .reduce(\n            (collection: any[], value: any) => (reducers[key] ? reducers[key](collection, value) : defaultReducer(collection, value)),\n            []\n          )\n      );\n\n      return;\n    }\n\n    // Object\n    if (isArrayOrArrayClass(obj)) {\n      set(key, deepExtends(undefined, value, reducers));\n    } else {\n      set(key, deepExtends(out[key], value, reducers));\n    }\n  });\n\n  if (isArrayOrArrayClass(out)) {\n    out.reduce((collection: any[], value: any) => defaultReducer(collection, value), []);\n  }\n\n  return out;\n}\n"]}